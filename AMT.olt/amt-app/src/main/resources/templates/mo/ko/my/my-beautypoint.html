<html ap:decorate="~{layout/layout-contents}">
<body>
<!-- #ap_container -->
<div ap:fragment="layout-contents">

	<div class="ap_contents my_beauty_point">
		<div class="section pd_md">
			<!--/* 뷰티포인트 요약 */-->
			<dl class="point_summary">
				<dt>사용 가능 뷰티포인트 <em th:text="${#IntegUtil.toCommaNumber(point.rmnPt) + 'P'}">2,000P</em></dt>
				<dd class="ui_table">
					<dl>
						<dt>회원등급</dt>
						<dd>
							<span class="inline-block">
								<span class="font_lg" th:text="${prfrinq.expcIiwcGrd}">일반회원</span>
								<small class="block font_xxs">구매금액 <span class="color_black" th:text="${prfrinq.purAcmlRt}">2%</span> 적립</small>
							</span>
						</dd>
					</dl>
					<dl>
						<dt>사용가능 포인트</dt>
						<dd>
							<em class="font_xl"><b th:text="${#IntegUtil.toCommaNumber(point.rmnPt)}">9,999P</b></em>
						</dd>
					</dl>
					<dl>
						<dt>만료예정 포인트</dt>
						<dd>
							<a href="https://www.beautypoint.co.kr/content/beautypoint/ko-kr/my-beautypoint/point.html" target="_blank" title="마이뷰티포인트 새창" class="btn_gray_round">포인트 조회</a>
						</dd>
					</dl>
				</dd>
			</dl>
			<div class="align_center mgt15">
				<button type="button" onclick="openGuide1()" class="btn_md_neutral">뷰티포인트 정책 안내</button>
			</div>
			<!--/* 뷰티포인트 내역 */-->
			<div class="select_wrap mgt15">
				<select name="" title="뷰티포인트 내역 조회기간 선택">
					<option value="">전체기간</option>
				</select>
			</div>

			<div ap:replace="~{my/fragment/point-fragment :: beauty-point-list}"></div>
		</div>
	</div>
</div>

<!--/* 하단 js등을 실행하는 마지막 영역 */-->
<th:block ap:fragment="layout-endpoint">
	<script>

	var date = new Object();
	var pageNumber = 1;
	var progress = '<div id="m-loading"><ul class="loading"><li></li><li></li><li></li></ul></div>';
		//multiple date picker적용
		$( '.ui_multiple_date_picker' ).multipleDatePicker({
			defaultRangeDate: '1months',
			minDate: moment().subtract( 50, 'years' )
		}).on( 'multiple-date-picker-change', function (e) {
			console.log( e.type, e.date );
			date = e.date;
			$('.table-data:last').after(progress);
			$(".table-data").remove();
			$.get("/my/page/info/beautyPointListFragment?startDt="+e.date.startDate + "&endDt="+e.date.endDate, function(data) {
				$("#m-loading").before(data);
				$("#m-loading").remove();
				pageNumber = 1;
			});
		});
		function more() {
			pageNumber++;
			$('.table-data:last').after(progress);
			$.get("/my/page/info/beautyPointListBodyFragment?pageNumber=" + pageNumber + "&startDt="+date.startDate + "&endDt="+date.endDate, function(data) {
				$("#m-loading").remove();
				$(".table-data:last").after(data);
			});
		}
		function openGuide1() {

			$.get("/my/page/info/beutyPointGuide1", function(data) {
				$('#send').removeAttr("disabled");
				/**
				 * 동적으로 생성된 modal의 Node Element 접근하기
				 * alert, confirm, info 모두 동일
				 */

				var contents = new Object();
				contents.contents = data;
				var modal = AP.modal.full(contents);
				var $modalEl = modal.getElement(); //jquery object


			});
		}
	</script>
</th:block>

</body>
</html>
